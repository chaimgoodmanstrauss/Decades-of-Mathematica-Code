(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='%s' *)
(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       131,          6]
NotebookDataLength[      4769,        204]
NotebookOptionsPosition[      3341,        149]
NotebookOutlinePosition[      3889,        174]
CellTagsIndexPosition[      3846,        171]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{


Cell["Precision:", "Text"],

Cell["n[x_]:=N[x,20]", "Input",
 InitializationCell->True],

Cell["\<\
Hyperbolic Geometry:

First 
Given two points z=A+iC  and w=B+iD,    t + i0  is the center of the \
hyperbolic line in
the upper half plane model that runs between w and z;   R is the radius of \
this line.
More formally:\
\>", "Text"],

Cell["Solve[{(A-t)^2+C^2==(B-t)^2+D^2},{t}, MakeRules->False]", "Text"],

Cell[CellGroupData[{Cell["T=(A^2 - B^2 + C^2 - D^2)/(2*(A - B))", "Input",
 InitializationCell->True],

Cell[OutputFormData["\<\
(A^2 - B^2 + C^2 - D^2)/(2*(A - B))\
\>", "\<\
 2    2    2    2
A  - B  + C  - D
-----------------
    2 (A - B)\
\>"], "Output"]}, Open]],

Cell["R=Sqrt[Factor[Together[(A-t)^2+C^2]]]", "Text",
 InitializationCell->True],

Cell[CellGroupData[{Cell["\<\
R=((A^2-2*A*B+B^2 + C^2 - 2*C*D + D^2)*
 
       (A^2 - 2*A*B + B^2 + C^2 + 2*C*D + D^2))^
 
   (1/2)/(2(-A + B))\
\>", "Input",
 InitializationCell->True],

Cell[OutputFormData["\<\
((A^2 - 2*A*B + B^2 + C^2 - 2*C*D + D^2)*
 
     (A^2 - 2*A*B + B^2 + C^2 + 2*C*D + D^2))^(1/2)/
 
  (2*(-A + B))\
\>", "\<\
       2            2    2            2
Sqrt[(A  - 2 A B + B  + C  - 2 C D + D ) 
 
      2            2    2            2
    (A  - 2 A B + B  + C  + 2 C D + D )] / (2 (-A + B))\
\>"], "Output"]}, Open]],

Cell["\<\
Cent[w_,z_]:=Block[{A=z[[1]],B=w[[1]],C=z[[2]],D=w[[2]]},
\t\t\t\tIf[A==B,inf,n[T]]]\
\>", "Input",
 InitializationCell->True],

Cell["\<\
Rad[w_,z_]:=Block[{A=z[[1]],B=w[[1]],C=z[[2]],D=w[[2]]},
\t\t\tIf[A==B,inf,n[Abs[R]]]]\
\>", "Input",
 InitializationCell->True],

Cell["\<\
Distance[w_,z_]:=Block[{A=z[[1]],B=w[[1]],C=z[[2]],D=w[[2]],
\t\t\t\tr=Rad[w,z],t=Cent[w,z]},
\t{r,t\t,
If[r===inf, n[Abs[Log[C/D]]],  
\t If[Positive[(A-t)/(B-t)], 
\t\tn[Abs[Log[(r+Abs[A-t])D/C/(r+Abs[B-t]) ]]],
\t\tn[Abs[Log[(r+Abs[A-t])/C]] +Abs[Log[(r+Abs[B-t])/D]]]
\t] ,{0}] }
\t]\
\>", "Input",
 InitializationCell->True],

Cell["\<\


Use a mobius transformation
line  zw, with rt hand end b=T+R and left hand end a=T-R  (thus azwb)
to a->0, z->i , w->Phi[w,z] b->infinity

Then take Phi^-1 of w^2.\
\>", "Text"],

Cell["phi[x_]:=(x+r-t)(Z-r-t)/(x-r-t)/(Z+r-t)", "Input",
 InitializationCell->True],

Cell["\<\
phiinv[x_]:=Block[{p1=phi[1],p0=phi[0],pi=(Z-r-t)/(Z+r-t)},

\t(p1-pi)(x-p0)/(p1-p0)/(x-pi)]

\
\>", "Input",
 InitializationCell->True],

Cell["\<\


And so: we now give the eqn for the point   x  that lies on zw  d(z,w) beyond \
w:

z={A,C} \"=\" A+iC         w={B,D}
\
\>", "Text"],

Cell["\<\
NewPoint[{z_,w_}]:=Block[{A=z[[1]],B=w[[1]],
\t\t\t\tC=z[[2]],D=w[[2]],
\t\t\t\tr=Rad[w,z],t=Cent[w,z],Z=A+I*C},
\t
\tIf[B===A, n[{B,D^2/C}], 
\t\tBlock[{NP=n[phiinv[n[phi[B+I*D]^2]]]},
\t\t\t{Re[NP],Im[NP]} ],{0} ]]\
\>", "Input",
 InitializationCell->True],

Cell["\<\

\
\>", "Input"]
},
AutoGeneratedPackage->Automatic,
WindowToolbars->{},
CellGrouping->Manual,
WindowSize->{740, 867},
WindowMargins->{{156, Automatic}, {Automatic, 84}},
ShowCellLabel->True,
ShowCellTags->False,
RenderingOptions->{"ObjectDithering"->True,
"RasterDithering"->False},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]

(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[533, 21, 26, 0, 70, "Text"],
Cell[562, 23, 58, 1, 70, "Input",
 InitializationCell->True],
Cell[623, 26, 245, 9, 70, "Text"],
Cell[871, 37, 71, 0, 70, "Text"],
Cell[CellGroupData[{
Cell[965, 39, 81, 1, 70, "Input",
 InitializationCell->True],
Cell[1049, 42, 155, 7, 70, "Output"]
}, Open  ]],
Cell[1216, 51, 80, 1, 70, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1319, 54, 165, 7, 70, "Input",
 InitializationCell->True],
Cell[1487, 63, 345, 12, 70, "Output"]
}, Open  ]],
Cell[1844, 77, 136, 4, 70, "Input",
 InitializationCell->True],
Cell[1983, 83, 138, 4, 70, "Input",
 InitializationCell->True],
Cell[2124, 89, 339, 11, 70, "Input",
 InitializationCell->True],
Cell[2466, 102, 189, 8, 70, "Text"],
Cell[2658, 112, 83, 1, 70, "Input",
 InitializationCell->True],
Cell[2744, 115, 146, 7, 70, "Input",
 InitializationCell->True],
Cell[2893, 124, 145, 8, 70, "Text"],
Cell[3041, 134, 268, 9, 70, "Input",
 InitializationCell->True],
Cell[3312, 145, 26, 3, 70, "Input"]
}
]
*)
