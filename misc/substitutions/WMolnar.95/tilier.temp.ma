(*^::[	Information =	"This is a Mathematica Notebook file.  It contains ASCII text, and can be	transferred by email, ftp, or other text-file transfer utility.  It should	be read or edited using a copy of Mathematica or MathReader.  If you 	received this as email, use your mail application or copy/paste to save 	everything from the line containing (*^ down to the line containing ^*)	into a plain text file.  On some systems you may have to give the file a 	name ending with ".ma" to allow Mathematica to recognize it as a Notebook.	The line below identifies what version of Mathematica created this file,	but it can be opened using any other version as well.";	FrontEndVersion = "NeXT Mathematica Notebook Front End Version 2.2";	NeXTStandardFontEncoding; 		fontset = title, inactive, noPageBreakBelow, noPageBreakInGroup, nohscroll, preserveAspect, groupLikeTitle, center, M7, bold, L1, e8,  24, "Times"; ;	fontset = subtitle, inactive, noPageBreakBelow, noPageBreakInGroup, nohscroll, preserveAspect, groupLikeTitle, center, M7, bold, L1, e6,  18, "Times"; ;	fontset = subsubtitle, inactive, noPageBreakBelow, noPageBreakInGroup, nohscroll, preserveAspect, groupLikeTitle, center, M7, italic, L1, e6,  14, "Times"; ;	fontset = section, inactive, noPageBreakBelow, nohscroll, preserveAspect, groupLikeSection, grayBox, M22, bold, L1, a20,  18, "Times"; ;	fontset = subsection, inactive, noPageBreakBelow, nohscroll, preserveAspect, groupLikeSection, blackBox, M19, bold, L1, a15,  14, "Times"; ;	fontset = subsubsection, inactive, noPageBreakBelow, nohscroll, preserveAspect, groupLikeSection, whiteBox, M18, bold, L1, a12,  12, "Times"; ;	fontset = text, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, L1,  12;	fontset = smalltext, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, L1,  10, "Times"; ;	fontset = input, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeInput, M42, N23, bold, L1,  12, "Courier"; ;	fontset = output, output, inactive, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeOutput, M42, N23, L-5,  12, "Courier"; ;	fontset = message, inactive, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeOutput, M42, N23, L1,  12, "Courier"; ;	fontset = print, inactive, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeOutput, M42, N23, L1,  12, "Courier"; ;	fontset = info, inactive, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeOutput, M42, N23, L1,  12, "Courier"; ;	fontset = postscript, PostScript, formatAsPostScript, output, inactive, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeGraphics, M7, l34, w282, h287, L1,  12, "Courier"; ;	fontset = name, inactive, noPageBreakInGroup, nohscroll, preserveAspect, M7, italic, B65535, L1,  10, "Times"; ;	fontset = header, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, italic, L1,  12, "Times"; ;	fontset = leftheader,  12;	fontset = footer, inactive, nohscroll, noKeepOnOnePage, preserveAspect, center, M7, italic, L1,  12, "Times"; ;	fontset = leftfooter,  12;	fontset = help, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, L1,  12;	fontset = clipboard, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, L1,  12;	fontset = completions, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, L1,  12, "Courier"; ;	fontset = special1, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, L1,  12;	fontset = special2, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, L1,  12;	fontset = special3, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, L1,  12;	fontset = special4, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, L1,  12;	fontset = special5, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, L1,  12;	paletteColors = 128; remoteKernel = "freeabel"; ]:[font = subsection; inactive; preserveAspect; startGroup]Gettin' Ready:[font = input; initialization; preserveAspect]*)R= {{0, 1, 0, 0, 0},    {0, 0, 1, 0, 0},    {0, 0, 0, 1, 0},    {0, 0, 0, 0, 1},    {-1,0, 0, 0, 0}};    Id= IdentityMatrix[5];Det[x Id - R] //Factor;(*:[font = input; initialization; preserveAspect; startGroup]*)rotate[1]:= Rrotate[0]:= Idrotate[-1]:= rotate[-1] = Inverse[R]rotate[n_Integer?Positive]:= rotate[n] = R.rotate[n-1]rotate[n_Integer?Negative]:= rotate[n] = rotate[-1].rotate[n+1]phi= N[(1 + Sqrt[5])/2]phibar:= (1 - Sqrt[5])/2p[x_]:= x.x - phi x + Idq[x_]:= x.x - phibar x + Idr[x_]:= x + Idv1= Last [NullSpace[p[R]]];v2= (rotate[2].v1 + rotate[3].v1) / phi //Simplify;v3= Last [NullSpace[q[R]]];v4= (rotate[2].v3 + rotate[3].v3) / phi //Simplify;v5= Flatten [NullSpace[r[R]]];basis = Map [#/ Sqrt[#.#] &, {v1, v2, v3, v4, v5}] //N;basis.Transpose[basis] //Chopchangecoordinates[pt_]:= basis.pt(*:[font = input; preserveAspect; startGroup]Sq3=Sqrt[3]/2   //N:[font = output; output; inactive; preserveAspect; endGroup; endGroup]0.866025403784439;[o]0.866025:[font = input; initialization; preserveAspect]*)inslab[pt_, offsetvector_]:=             (snee=N[Abs[changecoordinates[pt][[3]] - offsetvector[[2]] ]];            spee=N[Abs[changecoordinates[pt][[4]] - offsetvector[[3]] ]];            sqee= N[Abs[changecoordinates[pt][[5]] - offsetvector[[1]] ]]; TrueQ [           (snee <= (phi/2)) &&           (spee <=  (phi/2)) &&            (sqee <= (phi/2))                                   ])(*:[font = input; preserveAspect; startGroup]InSlab[{1,0,1,0,1},offset]:[font = output; output; inactive; preserveAspect; endGroup]True;[o]True:[font = input; initialization; Cclosed; preserveAspect; startGroup]*)offset:= {1.118034, .001, .011}p1= {0, 0, 0, 0, -1} + v5inslab[p1, offset]project[p1]p2= p1 + {-1, 0, 0, 0, 0}inslab[p2, offset]project[p2]p3= p2 + {0, 0, 0, 1, 0}inslab[p3, offset]project[p3]p4= p3 + {1, 0, 0, 0, 0}inslab[p4, offset]project[p4](*:[font = output; output; inactive; preserveAspect]{1, -1, 1, -1, 0};[o]{1, -1, 1, -1, 0}:[font = output; output; inactive; preserveAspect]True;[o]True:[font = output; output; inactive; preserveAspect]project[{1, -1, 1, -1, 0}];[o]project[{1, -1, 1, -1, 0}]:[font = output; output; inactive; preserveAspect]{0, -1, 1, -1, 0};[o]{0, -1, 1, -1, 0}:[font = output; output; inactive; preserveAspect]False;[o]False:[font = output; output; inactive; preserveAspect]project[{0, -1, 1, -1, 0}];[o]project[{0, -1, 1, -1, 0}]:[font = output; output; inactive; preserveAspect]{0, -1, 1, 0, 0};[o]{0, -1, 1, 0, 0}:[font = output; output; inactive; preserveAspect]False;[o]False:[font = output; output; inactive; preserveAspect]project[{0, -1, 1, 0, 0}];[o]project[{0, -1, 1, 0, 0}]:[font = output; output; inactive; preserveAspect]{1, -1, 1, 0, 0};[o]{1, -1, 1, 0, 0}:[font = output; output; inactive; preserveAspect]False;[o]False:[font = output; output; inactive; preserveAspect; endGroup; endGroup]project[{1, -1, 1, 0, 0}];[o]project[{1, -1, 1, 0, 0}]:[font = input; preserveAspect; startGroup]initvertices=InitialTile;InSlab[{1,0,1,0,1},offset] Show[Graphics[Incidences[p2],AspectRatio->Automatic,PlotRange->All]]:[font = output; output; inactive; preserveAspect]True;[o]True:[font = postscript; PostScript; formatAsPostScript; output; inactive; preserveAspect; pictureLeft = 34; pictureWidth = 268; pictureHeight = 282]%!%%Creator: Mathematica%%AspectRatio: 1.05146 MathPictureStart%% Graphics/Courier findfont 10  scalefont  setfont% Scaling calculations-0.66534 0.526463 -0.284413 0.526463 [[ 0 0 0 0 ][ 1 1.05146 0 0 ]] MathScale% Start of Graphics1 setlinecap1 setlinejoinnewpath[ ] 0 setdash0 gpPp.004 w.44973 .52573 m.97619 .52573 Ls.44973 .52573 m.97619 .52573 Ls.44973 .52573 m.61241 .02503 Ls.44973 .52573 m.02381 .21628 Ls.44973 .52573 m.61241 1.02643 LsP0 0 m1 0 L1 1.05146 L0 1.05146 Lclosepathclipnewpath% End of GraphicsMathPictureEnd:[font = output; output; inactive; preserveAspect; endGroup]The Unformatted text for this cell was not generated.Use options in the Actions Preferences dialog box to control when Unformatted text is generated.;[o]-Graphics-:[font = input; preserveAspect; startGroup]p1={1,0,1,0,0};p2={1,1,1,0,0};p3={1,1,1,0,1};p4={1,0,1,0,1};{InSlab[p1,offset],InSlab[p2,offset],InSlab[p3,offset],InSlab[p4,offset]}:[font = output; output; inactive; preserveAspect; endGroup]{True, True, False, True};[o]{True, True, False, True}:[font = input; preserveAspect; startGroup] Show[Graphics[Join@@Table[Incidences[initvertices[[k]]],{k,1,2}]],AspectRatio->Automatic,PlotRange->All]:[font = postscript; PostScript; formatAsPostScript; output; inactive; preserveAspect; pictureLeft = 34; pictureWidth = 276; pictureHeight = 244]%!%%Creator: Mathematica%%AspectRatio: .88639 MathPictureStart%% Graphics/Courier findfont 10  scalefont  setfont% Scaling calculations-0.0809609 0.339044 0.0211046 0.339044 [[ 0 0 0 0 ][ 1 .88639 0 0 ]] MathScale% Start of Graphics1 setlinecap1 setlinejoinnewpath[ ] 0 setdash0 gpPp.004 w.36285 .34355 m.46762 .0211 Ls.36285 .34355 m.25808 .0211 Ls.36285 .34355 m.02381 .34355 Ls.36285 .34355 m.08856 .54284 Ls.36285 .34355 m.63715 .54284 Ls.63715 .54284 m.97619 .54284 Ls.63715 .54284 m.97619 .54284 Ls.63715 .54284 m.74192 .22039 Ls.63715 .54284 m.36285 .34355 Ls.63715 .54284 m.74192 .86529 LsP0 0 m1 0 L1 .88639 L0 .88639 Lclosepathclipnewpath% End of GraphicsMathPictureEnd:[font = output; output; inactive; preserveAspect; endGroup]The Unformatted text for this cell was not generated.Use options in the Actions Preferences dialog box to control when Unformatted text is generated.;[o]-Graphics-:[font = subsection; inactive; preserveAspect; startGroup]Constructing a Large Patch of Penrose Tiles in R5:[font = text; inactive; preserveAspect]One first finds a single tile lying in the slab. At each stage, one has a  list of vertices, and a list of tiles expressed as lists of names of vertices,  and a list of vertices  around the boundary of the patch. For each edge on the boundary, one  finds the adjacent tile and replaces the edge in the string with  two edges (if tile parallel to tile found just before) or three edges (otherwise),and kills off the last new edge if parallel to the last tile:[font = input; preserveAspect]:[font = input; initialization; preserveAspect]*)InSlab=inslab;(*:[font = input; initialization; preserveAspect]*)InitialTile={p1,p2,p3,p4};(*:[font = input; initialization; preserveAspect]*)initboundary={ {1,2},{2,3},{3,4},{4,1}  };(*:[font = input; initialization; preserveAspect]*)initvertices=InitialTile;(*:[font = input; initialization; preserveAspect]*)inittiles={ {1,2,3,4} };(*:[font = text; inactive; preserveAspect] tiles and edges are given as lists of numbers; these numbers are indices in the list VerticesTiles is the list of all tiles; Boundary is the list of edges in the boundary of the patch:[font = text; inactive; preserveAspect]Exapnd from takes an edge and looks for the vector orth. to the edge that lands in the slab; if parallel to Last,  removes  last edge from NewList and adds two new edges; otherwise, adds three .  Edge is Boundary[[BoundaryIndex]];  if edge itself parallel to last, ignore and move on.   Directions are cyclic perms of +/- {0,0,0,1,0};  R shifts  these "counterclockwise":[font = input; initialization; preserveAspect]*)Dir[Edge_,Vertices_]:=Vertices[[Edge[[2]] ]]-Vertices[[Edge[[1]] ]](*:[font = input; initialization; preserveAspect]*)RR={ {0,0,0,0,-1}, {1,0,0,0,0},{0,1,0,0,0},		{0,0,1,0,0},{0,0,0,1,0}};(*:[font = input; initialization; preserveAspect]*)GetNorm[Edge_,Vertices_]:=	(rr=R.Dir[Edge,Vertices]; e=Vertices[[Edge[[1]] ]]+rr;f=Vertices[[Edge[[2]] ]]+rr;		While[ Not[InSlab[e,offset]&& InSlab[f,offset]], rr=R.rr; f=Vertices[[Edge[[2]] ]]+rr;		e=Vertices[[Edge[[1]] ]]+rr ];		rr);(*:[font = subsubsection; inactive; preserveAspect; startGroup]Aside:[font = input; initialization; preserveAspect; startGroup]*)zz=Chop[N[Table[{Cos[Pi*k/5],Sin[Pi*k/5]},{k,0,4}],4]]proj[pt_]:=pt.zz(*:[font = output; output; inactive; initialization; preserveAspect; endGroup]{{1., 0}, {0.809016994374947, 0.5877852522924732},   {0.3090169943749474, 0.951056516295154},   {-0.3090169943749474, 0.951056516295154},   {-0.809016994374947, 0.5877852522924733}};[o]{{1., 0}, {0.809, 0.5878}, {0.309, 0.9511}, {-0.309, 0.9511}, {-0.809, 0.5878}}:[font = input; initialization; preserveAspect]*)Incidences[pt_]:=(    prpt=proj[pt];rr={1,0,0,0,0};i=1;    If[  InSlab[pt+rr,offset], Sploo={Line[{prpt,proj[pt+rr]}]},Sploo={}];Sploo;    While[i<=10, (*Sploo=Join[Sploo,{rr,InSlab[pt+rr,offset]}];*)                If[  InSlab[pt+rr,offset], Sploo=Join[Sploo,{Line[{prpt,proj[pt+rr]}]}]];rr=R.rr;i=1+i];                               Sploo                                )(*:[font = input; preserveAspect; startGroup] Show[Graphics[Join@@Table[Incidences[initvertices[[k]]],{k,1,4}]],AspectRatio->Automatic,PlotRange->All]:[font = postscript; PostScript; formatAsPostScript; output; inactive; preserveAspect; pictureLeft = 34; pictureTop = 1; pictureWidth = 396; pictureHeight = 232]%!%%Creator: Mathematica%%AspectRatio: .58779 MathPictureStart%% Graphics/Courier findfont 10  scalefont  setfont% Scaling calculations0.155425 0.263232 0.0139949 0.263232 [[ 0 0 0 0 ][ 1 .58779 0 0 ]] MathScale% Start of Graphics1 setlinecap1 setlinejoinnewpath[ ] 0 setdash0 gpPp.004 w.5 .26434 m.58134 .01399 Ls.5 .26434 m.28704 .41907 Ls.71296 .41907 m.97619 .41907 Ls.71296 .41907 m.97619 .41907 Ls.71296 .41907 m.5 .26434 Ls.5 .57379 m.28704 .41907 Ls.28704 .41907 m.5 .26434 Ls.28704 .41907 m.02381 .41907 LsP0 0 m1 0 L1 .58779 L0 .58779 Lclosepathclipnewpath% End of GraphicsMathPictureEnd:[font = output; output; inactive; preserveAspect; endGroup]The Unformatted text for this cell was not generated.Use options in the Actions Preferences dialog box to control when Unformatted text is generated.;[o]-Graphics-:[font = input; preserveAspect; endGroup]:[font = subsubsection; inactive; preserveAspect; startGroup]And back to the program:[font = text; inactive; preserveAspect]This gives a list; first elt is changed list of vertices; second is changed list of Newboundary, third is changed list of tiles:[font = input; initialization; preserveAspect; startGroup]*)ExpandFrom[{Vertices_,NewBoundary_,Tiles_,last_,BoundaryIndex_,Boundary_}]:=Block[{edge=Boundary[[BoundaryIndex]],v=Length[Vertices]},Block[{norm=GetNorm[edge,Vertices]},	If[Dir[edge,Vertices]===last,{Vertices,NewBoundary,Tiles,last,BoundaryIndex+1,Boundary} ,	If[norm===last, 	   {Join[Vertices,{Vertices[[edge[[2]]]]+norm}],		Join[Drop[NewBoundary,-1],{{v,v+1},{v+1,edge[[2]]} }],		Join[Tiles,{ {edge[[2]],edge[[1]],v,v+1} }] , norm,BoundaryIndex+1,Boundary},	(*Otherwise*)			{Join[Vertices,			  {Vertices[[edge[[1]]]]+norm,Vertices[[edge[[2]]]]+norm}],			Join[NewBoundary,{ {edge[[1]],v+1},{v+1,v+2},			             {v+2,edge[[2]]}   }],			Join[Tiles,{ {edge[[2]],edge[[1]],v+1,v+2} }],norm,BoundaryIndex+1,Boundary}		],ERROR] ] ]		(*:[font = message; inactive; preserveAspect; endGroup]General::spell1:    Possible spelling error: new symbol name "edge" is similar to existing symbol     "Edge".:[font = input; initialization; preserveAspect]*)WalkAround[{Vertices_,Boundary_,Tiles_}]:=	Drop[Nest[  ExpandFrom,  {Vertices,{},Tiles, Dir[Boundary[[-1]] ],1,Boundary} , Length[Boundary]],-3]		(*:[font = input; initialization; preserveAspect]*)ExpandPatch[{Vertices_,Boundary_,Tiles_},n_]:=     Nest[ WalkAround,{Vertices,Boundary,Tiles} , n](*:[font = input; preserveAspect; endGroup; endGroup]ExpandPatch[{initvertices,initboundary,inittiles},1]:[font = subsection; inactive; preserveAspect; startGroup]Draw a Patch:[font = input; preserveAspect; startGroup]zz=Chop[N[Table[{Cos[Pi*k/5],Sin[Pi*k/5]},{k,0,4}],4]]proj[pt_]:=pt.zz:[font = output; output; inactive; preserveAspect; endGroup]{{1., 0}, {0.809016994374947, 0.5877852522924732}, {0.3090169943749474, 0.951056516295154},   {-0.3090169943749474, 0.951056516295154}, {-0.809016994374947, 0.5877852522924733}};[o]{{1., 0}, {0.809, 0.5878}, {0.309, 0.9511}, {-0.309, 0.9511}, {-0.809, 0.5878}}:[font = input; preserveAspect; startGroup]Foo=ExpandPatch[{initvertices,initboundary,inittiles},3]vertices=Foo[[1]];tile= Foo[[3]];:[font = input; preserveAspect; startGroup]Foo={{{1, 0, 1, 0, 0}, {1, 1, 1, 0, 0}, {1, 1, 1, 0, 1}, {1, 0, 1, 0, 1},    {1, 0, 1, -1, 0}, {1, 1, 1, -1, 0}, {1, 1, 2, 0, 0}, {1, 1, 2, 0, 1},    {1, 0, 2, 0, 1}, {1, 1, 1, 0, 1}, {1, 1, 1, 0, 0}, {1, 1, 1, 0, 0},    {1, 1, 1, -1, 0}, {2, 1, 1, -1, 0}, {2, 1, 1, 0, 0}, {2, 1, 2, 0, 0},    {1, 1, 2, 1, 0}, {1, 1, 2, 1, 1}, {1, 0, 2, 1, 1}, {1, 1, 2, 0, 1},    {1, 1, 1, 0, 1}, {1, 0, 1, 0, 1}, {1, 0, 1, 0, 0}, {1, 0, 1, -1, 0},    {1, 1, 1, -1, 0}, {1, 1, 1, 0, 0}, {1, 0, 1, 0, 0}, {1, 0, 1, -1, 0},    {2, 0, 1, -1, 0}, {2, 1, 2, -1, 0}, {2, 1, 2, 0, 0}, {2, 1, 2, 0, 1},    {1, 1, 2, 0, 1}, {2, 1, 2, 0, 0}, {2, 1, 2, 1, 0}, {2, 1, 2, 1, 1},    {0, 1, 2, 1, 1}, {0, 0, 2, 1, 1}, {1, 1, 2, 1, 1}, {1, 1, 2, 0, 1},    {1, 0, 2, 0, 1}, {1, 0, 1, 0, 1}, {1, 1, 1, 0, 1}, {1, 1, 1, 0, 0}},   {{1, 24}, {24, 25}, {25, 12}, {13, 26}, {26, 27}, {27, 5}, {6, 28}, {28, 29},    {29, 14}, {14, 30}, {30, 31}, {31, 15}, {16, 32}, {32, 33}, {33, 7}, {7, 34},    {34, 35}, {35, 36}, {36, 18}, {18, 37}, {37, 38}, {38, 19}, {19, 39},    {39, 40}, {40, 9}, {20, 41}, {41, 42}, {42, 21}, {22, 43}, {43, 44}, {44, 23}}\   , {{1, 2, 3, 4}, {2, 1, 5, 6}, {3, 2, 7, 8}, {4, 3, 8, 9}, {1, 4, 10, 11},    {5, 1, 12, 13}, {2, 6, 14, 15}, {7, 2, 15, 16}, {8, 7, 17, 18},    {9, 8, 18, 19}, {4, 9, 20, 21}, {11, 10, 22, 23}, {12, 1, 24, 25},    {5, 13, 26, 27}, {14, 6, 28, 29}, {15, 14, 30, 31}, {7, 16, 32, 33},    {17, 7, 34, 35}, {18, 17, 35, 36}, {19, 18, 37, 38}, {9, 19, 39, 40},    {21, 20, 41, 42}, {23, 22, 43, 44}}}:[font = output; output; inactive; preserveAspect; endGroup; endGroup]{{{1, 0, 1, 0, 0}, {1, 1, 1, 0, 0}, {1, 1, 1, 0, 1}, {1, 0, 1, 0, 1},    {1, 0, 1, -1, 0}, {1, 1, 1, -1, 0}, {1, 1, 2, 0, 0}, {1, 1, 2, 0, 1},    {1, 0, 2, 0, 1}, {1, 1, 1, 0, 1}, {1, 1, 1, 0, 0}, {1, 1, 1, 0, 0},    {1, 1, 1, -1, 0}, {2, 1, 1, -1, 0}, {2, 1, 1, 0, 0}, {2, 1, 2, 0, 0},    {1, 1, 2, 1, 0}, {1, 1, 2, 1, 1}, {1, 0, 2, 1, 1}, {1, 1, 2, 0, 1},    {1, 1, 1, 0, 1}, {1, 0, 1, 0, 1}, {1, 0, 1, 0, 0}, {1, 0, 1, -1, 0},    {1, 1, 1, -1, 0}, {1, 1, 1, 0, 0}, {1, 0, 1, 0, 0}, {1, 0, 1, -1, 0},    {2, 0, 1, -1, 0}, {2, 1, 2, -1, 0}, {2, 1, 2, 0, 0}, {2, 1, 2, 0, 1},    {1, 1, 2, 0, 1}, {2, 1, 2, 0, 0}, {2, 1, 2, 1, 0}, {2, 1, 2, 1, 1},    {0, 1, 2, 1, 1}, {0, 0, 2, 1, 1}, {1, 1, 2, 1, 1}, {1, 1, 2, 0, 1},    {1, 0, 2, 0, 1}, {1, 0, 1, 0, 1}, {1, 1, 1, 0, 1}, {1, 1, 1, 0, 0}},   {{1, 24}, {24, 25}, {25, 12}, {13, 26}, {26, 27}, {27, 5}, {6, 28}, {28, 29},    {29, 14}, {14, 30}, {30, 31}, {31, 15}, {16, 32}, {32, 33}, {33, 7}, {7, 34},    {34, 35}, {35, 36}, {36, 18}, {18, 37}, {37, 38}, {38, 19}, {19, 39},    {39, 40}, {40, 9}, {20, 41}, {41, 42}, {42, 21}, {22, 43}, {43, 44}, {44, 23}}\   , {{1, 2, 3, 4}, {2, 1, 5, 6}, {3, 2, 7, 8}, {4, 3, 8, 9}, {1, 4, 10, 11},    {5, 1, 12, 13}, {2, 6, 14, 15}, {7, 2, 15, 16}, {8, 7, 17, 18},    {9, 8, 18, 19}, {4, 9, 20, 21}, {11, 10, 22, 23}, {12, 1, 24, 25},    {5, 13, 26, 27}, {14, 6, 28, 29}, {15, 14, 30, 31}, {7, 16, 32, 33},    {17, 7, 34, 35}, {18, 17, 35, 36}, {19, 18, 37, 38}, {9, 19, 39, 40},    {21, 20, 41, 42}, {23, 22, 43, 44}}};[o]{{{1, 0, 1, 0, 0}, {1, 1, 1, 0, 0}, {1, 1, 1, 0, 1}, {1, 0, 1, 0, 1},     {1, 0, 1, -1, 0}, {1, 1, 1, -1, 0}, {1, 1, 2, 0, 0}, {1, 1, 2, 0, 1},     {1, 0, 2, 0, 1}, {1, 1, 1, 0, 1}, {1, 1, 1, 0, 0}, {1, 1, 1, 0, 0},     {1, 1, 1, -1, 0}, {2, 1, 1, -1, 0}, {2, 1, 1, 0, 0}, {2, 1, 2, 0, 0},     {1, 1, 2, 1, 0}, {1, 1, 2, 1, 1}, {1, 0, 2, 1, 1}, {1, 1, 2, 0, 1},     {1, 1, 1, 0, 1}, {1, 0, 1, 0, 1}, {1, 0, 1, 0, 0}, {1, 0, 1, -1, 0},     {1, 1, 1, -1, 0}, {1, 1, 1, 0, 0}, {1, 0, 1, 0, 0}, {1, 0, 1, -1, 0},     {2, 0, 1, -1, 0}, {2, 1, 2, -1, 0}, {2, 1, 2, 0, 0}, {2, 1, 2, 0, 1},     {1, 1, 2, 0, 1}, {2, 1, 2, 0, 0}, {2, 1, 2, 1, 0}, {2, 1, 2, 1, 1},     {0, 1, 2, 1, 1}, {0, 0, 2, 1, 1}, {1, 1, 2, 1, 1}, {1, 1, 2, 0, 1},     {1, 0, 2, 0, 1}, {1, 0, 1, 0, 1}, {1, 1, 1, 0, 1}, {1, 1, 1, 0, 0}},    {{1, 24}, {24, 25}, {25, 12}, {13, 26}, {26, 27}, {27, 5}, {6, 28}, {28, 29},     {29, 14}, {14, 30}, {30, 31}, {31, 15}, {16, 32}, {32, 33}, {33, 7}, {7, 34},     {34, 35}, {35, 36}, {36, 18}, {18, 37}, {37, 38}, {38, 19}, {19, 39},     {39, 40}, {40, 9}, {20, 41}, {41, 42}, {42, 21}, {22, 43}, {43, 44}, {44, 23}}\    , {{1, 2, 3, 4}, {2, 1, 5, 6}, {3, 2, 7, 8}, {4, 3, 8, 9}, {1, 4, 10, 11},     {5, 1, 12, 13}, {2, 6, 14, 15}, {7, 2, 15, 16}, {8, 7, 17, 18},     {9, 8, 18, 19}, {4, 9, 20, 21}, {11, 10, 22, 23}, {12, 1, 24, 25},     {5, 13, 26, 27}, {14, 6, 28, 29}, {15, 14, 30, 31}, {7, 16, 32, 33},     {17, 7, 34, 35}, {18, 17, 35, 36}, {19, 18, 37, 38}, {9, 19, 39, 40},     {21, 20, 41, 42}, {23, 22, 43, 44}}}:[font = input; preserveAspect]Splee= Join[Table[  Text[k,proj[vertices[[k]]]+Log[k] {.05,.05}],{k,1,Length[vertices]}],Join@@Table[   {Line [ {proj [vertices [[tile [[k]] [[1]]]] ],proj[vertices[[tile[[k]][[2]]]]]} ],Line[{proj[vertices[[tile[[k]][[2]]]]],proj[vertices[[tile[[k]][[3]]]]]} ],Line[{proj[vertices[[tile[[k]][[3]]]]],proj[vertices[[tile[[k]][[4]]]]]} ],Line[{proj[vertices[[tile[[k]][[4]]]]],proj[vertices[[tile[[k]][[1]]]]]} ]},{k,1,Length[tile]}] ];:[font = input; preserveAspect; startGroup]Show[Graphics[Splee],AspectRatio->Automatic]:[font = postscript; PostScript; formatAsPostScript; output; inactive; thinLines; preserveAspect; pictureLeft = 34; pictureWidth = 639; pictureHeight = 609]%!%%Creator: Mathematica%%AspectRatio: .95592 MathPictureStart%% Graphics/Courier findfont 10  scalefont  setfont% Scaling calculations0.131884 0.216149 0.0227601 0.216149 [[ 0 0 0 0 ][ 1 .95592 0 0 ]] MathScale% Start of Graphics1 setlinecap1 setlinejoinnewpath[ ] 0 setdash0 gpP0 0 m1 0 L1 .95592 L0 .95592 Lclosepathclipnewpathp[(1)] .41483 .22833 0 0 Mshowa[(2)] .59719 .36287 0 0 Mshowa[(3)] .4267 .4943 0 0 Mshowa[(4)] .25494 .37036 0 0 Mshowa[(5)] .49901 .04015 0 0 Mshowa[(6)] .67585 .16917 0 0 Mshowa[(7)] .67752 .58198 0 0 Mshowa[(8)] .50409 .71047 0 0 Mshowa[(9)] .3305 .5847 0 0 Mshowa[(10)] .43971 .50731 0 0 Mshowa[(11)] .61561 .38129 0 0 Mshowa[(12)] .61655 .38223 0 0 Mshowa[(13)] .68421 .17753 0 0 Mshowa[(14)] .90116 .17833 0 0 Mshowa[(15)] .83511 .38465 0 0 Mshowa[(16)] .9026 .59091 0 0 Mshowa[(17)] .62032 .79714 0 0 Mshowa[(18)] .44606 .92481 0 0 Mshowa[(19)] .27178 .79834 0 0 Mshowa[(20)] .514 .72038 0 0 Mshowa[(21)] .44773 .51533 0 0 Mshowa[(22)] .27337 .38879 0 0 Mshowa[(23)] .44871 .26222 0 0 Mshowa[(24)] .51597 .05711 0 0 Mshowa[(25)] .69128 .1846 0 0 Mshowa[(26)] .62491 .39059 0 0 Mshowa[(27)] .45045 .26395 0 0 Mshowa[(28)] .51763 .05877 0 0 Mshowa[(29)] .73416 .05915 0 0 Mshowa[(30)] .97619 .39214 0 0 Mshowa[(31)] .90975 .59806 0 0 Mshowa[(32)] .73523 .72545 0 0 Mshowa[(33)] .51941 .72579 0 0 Mshowa[(34)] .91075 .59906 0 0 Mshowa[(35)] .84427 .80494 0 0 Mshowa[(36)] .6697 .9323 0 0 Mshowa[(37)] .2377 .93259 0 0 Mshowa[(38)] .06312 .80583 0 0 Mshowa[(39)] .45442 .93316 0 0 Mshowa[(40)] .52149 .72787 0 0 Mshowa[(41)] .34689 .60108 0 0 Mshowa[(42)] .28035 .39577 0 0 Mshowa[(43)] .45548 .52308 0 0 Mshowa[(44)] .63059 .39628 0 0 Mshowa.004 w.41483 .22833 m.5897 .35538 Ls.5897 .35538 m.41483 .48243 Ls.41483 .48243 m.23996 .35538 Ls.23996 .35538 m.41483 .22833 Ls.5897 .35538 m.41483 .22833 Ls.41483 .22833 m.48162 .02276 Ls.48162 .02276 m.65649 .14981 Ls.65649 .14981 m.5897 .35538 Ls.41483 .48243 m.5897 .35538 Ls.5897 .35538 m.65649 .56095 Ls.65649 .56095 m.48162 .688 Ls.48162 .688 m.41483 .48243 Ls.23996 .35538 m.41483 .48243 Ls.41483 .48243 m.48162 .688 Ls.48162 .688 m.30675 .56095 Ls.30675 .56095 m.23996 .35538 Ls.41483 .22833 m.23996 .35538 Ls.23996 .35538 m.41483 .48243 Ls.41483 .48243 m.5897 .35538 Ls.5897 .35538 m.41483 .22833 Ls.48162 .02276 m.41483 .22833 Ls.41483 .22833 m.5897 .35538 Ls.5897 .35538 m.65649 .14981 Ls.65649 .14981 m.48162 .02276 Ls.5897 .35538 m.65649 .14981 Ls.65649 .14981 m.87264 .14981 Ls.87264 .14981 m.80584 .35538 Ls.80584 .35538 m.5897 .35538 Ls.65649 .56095 m.5897 .35538 Ls.5897 .35538 m.80584 .35538 Ls.80584 .35538 m.87264 .56095 Ls.87264 .56095 m.65649 .56095 Ls.48162 .688 m.65649 .56095 Ls.65649 .56095 m.5897 .76652 Ls.5897 .76652 m.41483 .89357 Ls.41483 .89357 m.48162 .688 Ls.30675 .56095 m.48162 .688 Ls.48162 .688 m.41483 .89357 Ls.41483 .89357 m.23996 .76652 Ls.23996 .76652 m.30675 .56095 Ls.23996 .35538 m.30675 .56095 Ls.30675 .56095 m.48162 .688 Ls.48162 .688 m.41483 .48243 Ls.41483 .48243 m.23996 .35538 Ls.5897 .35538 m.41483 .48243 Ls.41483 .48243 m.23996 .35538 Ls.23996 .35538 m.41483 .22833 Ls.41483 .22833 m.5897 .35538 Ls.5897 .35538 m.41483 .22833 Ls.41483 .22833 m.48162 .02276 Ls.48162 .02276 m.65649 .14981 Ls.65649 .14981 m.5897 .35538 Ls.48162 .02276 m.65649 .14981 Ls.65649 .14981 m.5897 .35538 Ls.5897 .35538 m.41483 .22833 Ls.41483 .22833 m.48162 .02276 Ls.87264 .14981 m.65649 .14981 Ls.65649 .14981 m.48162 .02276 Ls.48162 .02276 m.69777 .02276 Ls.69777 .02276 m.87264 .14981 Ls.80584 .35538 m.87264 .14981 Ls.87264 .14981 m.93943 .35538 Ls.93943 .35538 m.87264 .56095 Ls.87264 .56095 m.80584 .35538 Ls.65649 .56095 m.87264 .56095 Ls.87264 .56095 m.69777 .688 Ls.69777 .688 m.48162 .688 Ls.48162 .688 m.65649 .56095 Ls.5897 .76652 m.65649 .56095 Ls.65649 .56095 m.87264 .56095 Ls.87264 .56095 m.80584 .76652 Ls.80584 .76652 m.5897 .76652 Ls.41483 .89357 m.5897 .76652 Ls.5897 .76652 m.80584 .76652 Ls.80584 .76652 m.63098 .89357 Ls.63098 .89357 m.41483 .89357 Ls.23996 .76652 m.41483 .89357 Ls.41483 .89357 m.19868 .89357 Ls.19868 .89357 m.02381 .76652 Ls.02381 .76652 m.23996 .76652 Ls.30675 .56095 m.23996 .76652 Ls.23996 .76652 m.41483 .89357 Ls.41483 .89357 m.48162 .688 Ls.48162 .688 m.30675 .56095 Ls.41483 .48243 m.48162 .688 Ls.48162 .688 m.30675 .56095 Ls.30675 .56095 m.23996 .35538 Ls.23996 .35538 m.41483 .48243 Ls.41483 .22833 m.23996 .35538 Ls.23996 .35538 m.41483 .48243 Ls.41483 .48243 m.5897 .35538 Ls.5897 .35538 m.41483 .22833 LsP% End of GraphicsMathPictureEnd:[font = output; output; inactive; preserveAspect; endGroup; endGroup]The Unformatted text for this cell was not generated.Use options in the Actions Preferences dialog box to control when Unformatted text is generated.;[o]-Graphics-:[font = input; preserveAspect; startGroup]Table[InSlab[vertices[[k]],offset],{k,1,Length[vertices]}]:[font = output; output; inactive; preserveAspect; endGroup]{True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True,   True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True,   True, True, True, True, True, True, True, True, True, True, True, True};[o]{True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True,    True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True,    True, True, True, True, True, True, True, True, True, True, True, True}:[font = input; preserveAspect; startGroup]vertices=Foo[[1]];tiles= (#-1)& /@ Foo[[3]];:[font = message; inactive; preserveAspect]General::spell1:    Possible spelling error: new symbol name "vertices"     is similar to existing symbol "Vertices".:[font = message; inactive; preserveAspect; endGroup]General::spell1:    Possible spelling error: new symbol name "tiles" is similar to existing symbol     "Tiles".:[font = subsection; inactive; preserveAspect; startGroup]So Here it Goes::[font = input; preserveAspect]Foo=ExpandPatch[{initvertices,initboundary,inittiles},1];vertices=Foo[[1]];tiles= (#-1)& /@ Foo[[3]];:[font = input; preserveAspect]OOGLForm[vtxlist_, tilelist_,file_]:=(OpenWrite[file];     WriteString [file,"nOFF "]; (*Write[file,{} ];*)    WriteString [file,"5 " ];(*Write[file,{} ];*)     WriteString [file,TableForm[{ {Length[vtxlist] ,  Length[tilelist], 1 }}  ]];     WriteString [file," " ];(*Write[file,{} ];*)     WriteString [file,TableForm[ vtxlist , TableSpacing -> {0,1}]];     WriteString [file," "];(*Write[file,{} ];*)     WriteString[file,TableForm[ Map [Prepend [#, Length[#]] &, tilelist],             TableSpacing -> {0,1}]]; Close[file]     )          :[font = input; preserveAspect; startGroup] OOGLForm[vertices, tiles,"tile.3.off"]:[font = output; output; inactive; preserveAspect; endGroup]"tile.3.off";[o]tile.3.off:[font = input; preserveAspect; startGroup]Length[vertices]:[font = output; output; inactive; preserveAspect; endGroup] 1,;[o]870:[font = input; preserveAspect; startGroup]tiles:[font = output; output; inactive; preserveAspect; endGroup]{{0, 1, 2, 3}, {1, 0, 4, 5}, {2, 1, 6, 7}, {0, 3, 8, 9}};[o]{{0, 1, 2, 3}, {1, 0, 4, 5}, {2, 1, 6, 7}, {0, 3, 8, 9}}:[font = input; preserveAspect; startGroup]tiles /. i_Integer -> vertices[[i+1]]:[font = message; inactive; preserveAspect]Part::pspec: Part specification 1 + i     is neither an integer nor a list of non-zero integers.:[font = output; output; inactive; preserveAspect; endGroup]{{{1, -1, 1, 0, 0}, {0, -1, 1, 0, 0}, {0, -1, 1, -1, 0}, {1, -1, 1, -1, 0}},   {{0, -1, 1, 0, 0}, {1, -1, 1, 0, 0}, {1, -1, 0, 0, 0}, {0, -1, 0, 0, 0}},   {{0, -1, 1, -1, 0}, {0, -1, 1, 0, 0}, {1, -1, 1, 0, 0}, {1, -1, 1, -1, 0}},   {{1, -1, 1, 0, 0}, {1, -1, 1, -1, 0}, {0, -1, 1, -1, 0}, {0, -1, 1, 0, 0}}};[o]{{{1, -1, 1, 0, 0}, {0, -1, 1, 0, 0}, {0, -1, 1, -1, 0}, {1, -1, 1, -1, 0}},    {{0, -1, 1, 0, 0}, {1, -1, 1, 0, 0}, {1, -1, 0, 0, 0}, {0, -1, 0, 0, 0}},    {{0, -1, 1, -1, 0}, {0, -1, 1, 0, 0}, {1, -1, 1, 0, 0}, {1, -1, 1, -1, 0}},    {{1, -1, 1, 0, 0}, {1, -1, 1, -1, 0}, {0, -1, 1, -1, 0}, {0, -1, 1, 0, 0}}}:[font = input; preserveAspect; startGroup]project[x1_, x2_, x3_, x4_, x5_]:={basis[[1]].{x1, x2, x3, x4, x5},                                   basis[[2]].{x1, x2, x3, x4, x5}}Apply [project, Out[73], {2}]:[font = output; output; inactive; preserveAspect; endGroup]{{{0.3717480344601844, 0.1207882584319831}, {0., -0.3908790151697095},    {-0.3717480344601844, 0.1207882584319831}, {0., 0.6324555320336759}},   {{0., -0.3908790151697095}, {0.3717480344601844, 0.1207882584319831},    {-0.2297529205473612, 0.3162277660168379},    {-0.6015009550075457, -0.1954395075848548}},   {{-0.3717480344601844, 0.1207882584319831}, {0., -0.3908790151697095},    {0.3717480344601844, 0.1207882584319831}, {0., 0.6324555320336759}},   {{0.3717480344601844, 0.1207882584319831}, {0., 0.6324555320336759},    {-0.3717480344601844, 0.1207882584319831}, {0., -0.3908790151697095}}};[o]{{{0.371748, 0.120788}, {0., -0.390879}, {-0.371748, 0.120788}, {0., 0.632456}},    {{0., -0.390879}, {0.371748, 0.120788}, {-0.229753, 0.316228},     {-0.601501, -0.19544}}, {{-0.371748, 0.120788}, {0., -0.390879},     {0.371748, 0.120788}, {0., 0.632456}},    {{0.371748, 0.120788}, {0., 0.632456}, {-0.371748, 0.120788}, {0., -0.390879}}}:[font = input; preserveAspect; startGroup]Show[Graphics[Join[{GrayScale[1.0]},Map[Polygon, Out[92]]]]]:[font = postscript; PostScript; formatAsPostScript; output; inactive; preserveAspect; pictureLeft = 34; pictureWidth = 282; pictureHeight = 174]%!%%Creator: Mathematica%%AspectRatio: .61803 MathPictureStart%% Graphics/Courier findfont 10  scalefont  setfont% Scaling calculations0.612413 0.978558 0.239542 0.575182 [[ 0 0 0 0 ][ 1 .61803 0 0 ]] MathScale% Start of Graphics1 setlinecap1 setlinejoinnewpath[ ] 0 setdash0 gpP0 0 m1 0 L1 .61803 L0 .61803 Lclosepathclipnewpathp.97619 .30902 m.61241 .01472 L.24864 .30902 L.61241 .60332 LF.61241 .01472 m.97619 .30902 L.38759 .42143 L.02381 .12713 LF.24864 .30902 m.61241 .01472 L.97619 .30902 L.61241 .60332 LF.97619 .30902 m.61241 .60332 L.24864 .30902 L.61241 .01472 LFP% End of GraphicsMathPictureEnd:[font = output; output; inactive; preserveAspect; endGroup; endGroup]The Unformatted text for this cell was not generated.Use options in the Actions Preferences dialog box to control when Unformatted text is generated.;[o]-Graphics-^*)