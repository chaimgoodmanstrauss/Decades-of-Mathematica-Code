(*^::[	Information =	"This is a Mathematica Notebook file.  It contains ASCII text, and can be	transferred by email, ftp, or other text-file transfer utility.  It should	be read or edited using a copy of Mathematica or MathReader.  If you 	received this as email, use your mail application or copy/paste to save 	everything from the line containing (*^ down to the line containing ^*)	into a plain text file.  On some systems you may have to give the file a 	name ending with ".ma" to allow Mathematica to recognize it as a Notebook.	The line below identifies what version of Mathematica created this file,	but it can be opened using any other version as well.";	FrontEndVersion = "Macintosh Mathematica Notebook Front End Version 2.2";	MacintoshStandardFontEncoding; 		fontset = title, inactive, noPageBreakBelow, nohscroll, preserveAspect, groupLikeTitle, center, M7, bold, e8,  24, "Times"; 	fontset = subtitle, inactive, noPageBreakBelow, nohscroll, preserveAspect, groupLikeTitle, center, M7, bold, e6,  18, "Times"; 	fontset = subsubtitle, inactive, noPageBreakBelow, nohscroll, preserveAspect, groupLikeTitle, center, M7, italic, e6,  14, "Times"; 	fontset = section, inactive, noPageBreakBelow, nohscroll, preserveAspect, groupLikeSection, grayBox, M22, bold, a20,  18, "Times"; 	fontset = subsection, inactive, noPageBreakBelow, nohscroll, preserveAspect, groupLikeSection, blackBox, M19, bold, a15,  14, "Times"; 	fontset = subsubsection, inactive, noPageBreakBelow, nohscroll, preserveAspect, groupLikeSection, whiteBox, M18, bold, a12,  12, "Times"; 	fontset = text, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7,  12, "Times"; 	fontset = smalltext, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7,  10, "Times"; 	fontset = input, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeInput, M42, N23, bold, L-5,  12, "Courier"; 	fontset = output, output, inactive, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeOutput, M42, N23, L-5,  12, "Courier"; 	fontset = message, inactive, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeOutput, M42, N23, R65535, L-5,  12, "Courier"; 	fontset = print, inactive, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeOutput, M42, N23, L-5,  12, "Courier"; 	fontset = info, inactive, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeOutput, M42, N23, B65535, L-5,  12, "Courier"; 	fontset = postscript, PostScript, formatAsPostScript, output, inactive, noPageBreakInGroup, nowordwrap, preserveAspect, groupLikeGraphics, M7, l34, w282, h287,  12, "Courier"; 	fontset = name, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7, italic,  10, "Geneva"; 	fontset = header, inactive, noKeepOnOnePage, preserveAspect, M7,  12, "Times"; 	fontset = leftheader, inactive, L2,  12, "Times"; 	fontset = footer, inactive, noKeepOnOnePage, preserveAspect, center, M7,  12, "Times"; 	fontset = leftfooter, inactive, L2,  12, "Times"; 	fontset = help, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7,  10, "Times"; 	fontset = clipboard, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7,  12, "Times"; 	fontset = completions, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7,  12, "Times"; 	fontset = special1, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7,  12, "Times"; 	fontset = special2, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7,  12, "Times"; 	fontset = special3, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7,  12, "Times"; 	fontset = special4, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7,  12, "Times"; 	fontset = special5, inactive, nohscroll, noKeepOnOnePage, preserveAspect, M7,  12, "Times"; 	paletteColors = 128; automaticGrouping; currentKernel; ]:[font = input; preserveAspect; startGroup]Protect[e1,e2]:[font = output; output; inactive; preserveAspect; endGroup]{"e1", "e2"};[o]{e1, e2}:[font = input; preserveAspect; startGroup]elist={e1,e2}:[font = output; output; inactive; preserveAspect; endGroup]{e1, e2};[o]{e1, e2}:[font = input; preserveAspect; startGroup]Protect[elist]:[font = output; output; inactive; preserveAspect; endGroup]{"elist"};[o]{elist}:[font = input; preserveAspect](*Associative Law *)t[a_,b_,c__]:=t[a,t[b,c]];[s]2:0,1;20,0;47,-1;2:1,13,10,Courier,1,12,0,0,0;1,13,10,Times,0,12,0,0,0;:[font = input; preserveAspect](*Distributive Law*)t[a_,b_]/; Head[a]==Plus := Plus@@ (t[#,b]& /@ (List @@ a))t[a_,b_]/; Head[b]==Plus := Plus@@ (t[a,#]& /@ (List @@ b));[s]2:0,1;20,0;141,-1;2:1,13,10,Courier,1,12,0,0,0;1,13,10,Times,0,12,0,0,0;:[font = input; preserveAspect]t[a_,b_]/; (And @@ (FreeQ[a,#]& /@ {e1,e2})):= a bt[a_,b_]/; (And @@ (FreeQ[b,#]& /@ {e1,e2})):=  a b:[font = input; preserveAspect]t[e1,e2]:=t[e1,e2]:[font = input; preserveAspect]t[e2,e1]:=-t[e1,e2]:[font = input; preserveAspect]t[e1,e1]:=-1:[font = input; preserveAspect]t[e2,e2]:=-1:[font = input; preserveAspect]coeff[a_]/; Head[a]==Times && (And @@ (AtomQ /@ (List @@ a))):=	a /. {e1->1,e2->1}	:[font = input; preserveAspect]freeE[a_]:= FreeQ[a,#]&/@elist:[font = input; preserveAspect]coeff[a_]/; (MemberQ[{t,Times},Head[a]] && 	(And @@ ((MemberQ[{t,Times},Head[#]]|| (AtomQ[#] ))& /@ 	 (List @@ a)))) :=	(Times @@ (coeff /@ (List @@ a))) (Head[a] @@ (term  /@ (List @@ a)))	:[font = input; preserveAspect; startGroup]coeff[a_]/; (AtomQ[a] && freeE[a]):= a(coeff[#]=1)& /@ elist:[font = output; output; inactive; preserveAspect; endGroup]{1, 1};[o]{1, 1}:[font = input; preserveAspect]coeff[a_]/; Not[Head[a]==Times && (And @@ (AtomQ /@ (List @@ a)))]:=a:[font = input; preserveAspect]term[a_]:=a/coeff[a]:[font = input; preserveAspect]t[a_,b_]/; Head[a]==Times := coeff[a] t[term[a],b]t[a_,b_]/; Head[b]==Times := coeff[b] t[a,term[b]]:[font = input; preserveAspect; startGroup]Protect[t,coeff,term]:[font = output; output; inactive; preserveAspect; endGroup]{"t", "coeff", "rest"};[o]{t, coeff, rest}:[font = text; inactive; preserveAspect]:[font = subsubsection; inactive; preserveAspect; startGroup]Examples:[font = text; inactive; preserveAspect]To evaluate (2+e2+3 e1)(3+4 e1)::[font = input; preserveAspect; startGroup]t[2+  e2 +3e1, 3+4 e1]:[font = output; output; inactive; preserveAspect; endGroup]-6 + 17*e1 + 3*e2 - 4*t[e1, e2];[o]-6 + 17 e1 + 3 e2 - 4 t[e1, e2]:[font = text; inactive; preserveAspect; endGroup]Note that regular multiplcation can be used EXCEPT when dealing with terms that mix e's:[font = subsection; inactive; Cclosed; preserveAspect; startGroup]Scratch:[font = input; preserveAspect]coeff[a_]/; Head[a]==Times && (And @@ (AtomQ /@ (List @@ a))):=	a /. {e1->1,e2->1}:[font = input; preserveAspect]coeff[a_]/; Not[Head[a]==Times && (And @@ (AtomQ /@ (List @@ a)))]:=a:[font = input; preserveAspect]coeff[e1 e2 + 3]:[font = input; preserveAspect; startGroup]rest[a_]:=a/coeff[a]:[font = message; inactive; preserveAspect; endGroup]General::spell1:    Possible spelling error: new symbol name "rest"     is similar to existing symbol "Rest".:[font = input; preserveAspect; startGroup]rest[e1 2 e2]:[font = output; output; inactive; preserveAspect; endGroup]e1*e2;[o]e1 e2:[font = input; preserveAspect; startGroup]t[e1,e1]:[font = output; output; inactive; preserveAspect; endGroup]-1;[o]-1:[font = input; preserveAspect; startGroup]Head[a+b]:[font = output; output; inactive; preserveAspect; endGroup]Plus;[o]Plus:[font = input; preserveAspect; startGroup]List @@ (a+b):[font = output; output; inactive; preserveAspect; endGroup]{a, b};[o]{a, b}:[font = input; preserveAspect; startGroup]t[2+e2+c,z+e1]:[font = output; output; inactive; preserveAspect; endGroup]2*e1 + c*e1 + 2*z + c*z + e2*z - t[e1, e2];[o]2 e1 + c e1 + 2 z + c z + e2 z - t[e1, e2]:[font = input; preserveAspect; startGroup]t[e1,2]:[font = output; output; inactive; preserveAspect; endGroup]2*e1;[o]2 e1:[font = input; preserveAspect]t[a_,b_]/; (And @@((FreeQ[a,#] && FreeQ[b,#])&/@{e1,e2})) := Times[a,b]:[font = input; preserveAspect]Clear[t]:[font = input; preserveAspect]e1:[font = input; preserveAspect; startGroup]t[3(2 e1+e2+1),1+e2]:[font = output; output; inactive; preserveAspect; endGroup]-3 + 3*e2 + 3*(1 + 2*e1 + e2) + 6*t[e1, e2];[o]-3 + 3 e2 + 3 (1 + 2 e1 + e2) + 6 t[e1, e2]:[font = input; preserveAspect; startGroup]t[e1,3 e2]:[font = output; output; inactive; preserveAspect; endGroup]$Aborted;[o]$Aborted:[font = input; preserveAspect; startGroup]t[(List @@ (2 e1))[[1]],t[Sequence @@ Drop[List @@(2 e1),1],e2]]:[font = output; output; inactive; preserveAspect; endGroup]2*t[e1, e2];[o]2 t[e1, e2]:[font = input; preserveAspect]t[a_,b_]/; Head[a]==Times := t[(List @@ a)[[1]],t[Sequence @@ 	Drop[List @@ a,1],b]]t[a_,b_]/; Head[b]==Times := t[a,(List @@ b) [[1]],t[Sequence @@ 	Drop[List @@ b,1]]]:[font = input; preserveAspect; startGroup]t[2 e1,e2]:[font = output; output; inactive; preserveAspect; endGroup]2*t[e1, e2];[o]2 t[e1, e2]:[font = input; preserveAspect; startGroup]t[e1,(List @@ (2 e2)) [[1]],Sequence @@ 	Drop[List @@ (2 e2),1]]:[font = output; output; inactive; preserveAspect; endGroup]$Aborted;[o]$Aborted:[font = input; preserveAspect]:[font = input; preserveAspect; startGroup]t[2,t[e2]]:[font = output; output; inactive; preserveAspect; endGroup; endGroup]2*t[e2];[o]2 t[e2]:[font = subsection; inactive; preserveAspect; startGroup]More Generally:[font = input; preserveAspect]:[font = input; preserveAspect]dim=4; Protect[dim];:[font = input; preserveAspect]Unprotect[term,t,coeff];Clear[term,coeff,t];:[font = input; preserveAspect; startGroup]elist=Table[ToExpression["e"<>ToString[i]],{i,1,dim}]:[font = output; output; inactive; preserveAspect; endGroup]{e1, e2, e3, e4};[o]{e1, e2, e3, e4}:[font = input; preserveAspect]Protect @@ elist;Protect[elist];:[font = input; preserveAspect](*Associative Law *)t[a_,b_,c__]:=t[a,t[b,c]];[s]2:0,1;20,0;47,-1;2:1,13,10,Courier,1,12,0,0,0;1,13,10,Times,0,12,0,0,0;:[font = input; preserveAspect](*Distributive Law*)t[a_,b_]/; Head[a]==Plus := Plus@@ (t[#,b]& /@ (List @@ a))t[a_,b_]/; Head[b]==Plus := Plus@@ (t[a,#]& /@ (List @@ b));[s]2:0,1;20,0;141,-1;2:1,13,10,Courier,1,12,0,0,0;1,13,10,Times,0,12,0,0,0;:[font = input; preserveAspect]t[a_,b_]/; (And @@ (FreeQ[a,#]& /@ elist)):= a bt[a_,b_]/; (And @@ (FreeQ[b,#]& /@ elist)):=  a b:[font = input; preserveAspect]Table[t[elist[[i]],elist[[j]]]= 		If[i<j, t[elist[[i]],elist[[j]]],		If[i==j, -1,		If[i>j,-t[elist[[j]],elist[[i]] ]]]],	{i,1,dim},{j,1,dim}];	:[font = input; preserveAspect]coeff[a_]/; Head[a]==Times && (And @@ (AtomQ /@ (List @@ a))):=	a /. (#->1 & /@ elist)		(*need to deal with coeff[-t[a,b]]*)	coeff[a_]/; Not[Head[a]==Times && (And @@ (AtomQ /@ (List @@ a)))]:=a;[s]3:0,0;91,1;127,0;200,-1;2:2,13,10,Courier,1,12,0,0,0;1,13,10,Times,0,12,0,0,0;:[font = input; preserveAspect]term[a_]:=a/coeff[a]:[font = input; preserveAspect]t[a_,b_]/; Head[a]==Times := coeff[a] t[term[a],b]t[a_,b_]/; Head[b]==Times := coeff[b] t[a,term[b]]:[font = input; preserveAspect; startGroup]Protect[t,coeff,term]:[font = output; output; inactive; preserveAspect; endGroup]{"t", "coeff", "term"};[o]{t, coeff, term}:[font = input; preserveAspect; startGroup]Unprotect[coeff]:[font = output; output; inactive; preserveAspect; endGroup]{"coeff"};[o]{coeff}:[font = subsubsection; inactive; preserveAspect; startGroup]Examples:[font = input; preserveAspect; startGroup]t[(2 e2 +e3),(-e2 - e4 )]:[font = output; output; inactive; preserveAspect; endGroup]2 + t[e2, e3] - 2*t[e2, e4] - t[e3, e4];[o]2 + t[e2, e3] - 2 t[e2, e4] - t[e3, e4]:[font = text; inactive; preserveAspect]ok:[font = input; preserveAspect; startGroup]t[(2 e1 +e2),(-e3 - e4 ),e4]:[font = output; output; inactive; preserveAspect; endGroup]2*e1 + e2 - 2*e1*t[e3, e4] - e2*t[e3, e4];[o]2 e1 + e2 - 2 e1 t[e3, e4] - e2 t[e3, e4]:[font = text; inactive; preserveAspect]Somethings still wrong...:[font = input; preserveAspect]t[e1,-e2,e3]:[font = input; preserveAspect; startGroup]t[e1,-t[e2,e3]]:[font = output; output; inactive; preserveAspect; endGroup; endGroup; endGroup]-(e1*t[e2, e3]);[o]-(e1 t[e2, e3])^*)